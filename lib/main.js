!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Pando",[],t):"object"==typeof exports?exports.Pando=t():e.Pando=t()}(global,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var f=t[r]={i:r,l:!1,exports:{}};return e[r].call(f.exports,f,f.exports,n),f.l=!0,f.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var f in e)n.d(r,f,function(t){return e[t]}.bind(null,f));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(f,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function o(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?f(e.value):new n(function(t){t(e.value)}).then(i,o)}s((r=r.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,r,f,a,i={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(f=2&a[0]?r.return:a[0]?r.throw||((f=r.return)&&f.call(r),0):r.next)&&!(f=f.call(r,a[1])).done)return f;switch(r=0,f&&(a=[2&a[0],f.value]),a[0]){case 0:case 1:f=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(f=(f=i.trys).length>0&&f[f.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!f||a[1]>f[0]&&a[1]<f[3])){i.label=a[1];break}if(6===a[0]&&i.label<f[1]){i.label=f[1],f=a;break}if(f&&i.label<f[2]){i.label=f[2],i.ops.push(a);break}f[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=f=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(10)),o=n(28);n(27),t.ipld=function(e,t){return t=t||{},function(n){var r=Reflect.getMetadata("ipld",n)||{};return r[e]=t,Reflect.defineMetadata("ipld",r,n)}};var s=function(){function e(e){this.type=e}return e.prototype.cid=function(){return r(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return e=o.promisify(i.default.util.cid),[4,this.toIPLD()];case 1:return[4,e.apply(void 0,[t.sent()])];case 2:return[2,t.sent()]}})})},e.prototype.toIPLD=function(){return r(this,void 0,void 0,function(){var e,t,n,r,a,i,o,s,u,c,l,d,p,h,b,y,v,m,w,g,_,P,x,k,j;return f(this,function(f){switch(f.label){case 0:for(r in(e={})["@type"]=this.type,t=Reflect.getMetadata("ipld",this.constructor.prototype.constructor)||[],n=[],t)n.push(r);a=0,f.label=1;case 1:if(!(a<n.length))return[3,18];if(i=n[a],!t[i].link)return[3,16];switch(o=t[i].type,o){case"map":return[3,2];case"array":return[3,7];case"direct":return[3,12]}return[3,13];case 2:for(u in s=[],this[i])s.push(u);c=0,f.label=3;case 3:return c<s.length?(v=s[c],l=e,d=v,p={},h="/",[4,this[i][v].cid()]):[3,6];case 4:l[d]=(p[h]=f.sent().toBaseEncodedString(),p),f.label=5;case 5:return c++,[3,3];case 6:return[3,15];case 7:e[i]=[],b=0,y=this[i],f.label=8;case 8:return b<y.length?(v=y[b],w=(m=e[i]).push,g={},_="/",[4,v.cid()]):[3,11];case 9:w.apply(m,[(g[_]=f.sent().toBaseEncodedString(),g)]),f.label=10;case 10:return b++,[3,8];case 11:return[3,15];case 12:return e[i]={"/":this[i]},[3,15];case 13:return P=e,x=i,k={},j="/",[4,this[i].cid()];case 14:P[x]=(k[j]=f.sent().toBaseEncodedString(),k),f.label=15;case 15:return[3,17];case 16:e[i]=this[i],f.label=17;case 17:return a++,[3,1];case 18:return[2,e]}})})},e}();t.default=s},function(e,t){e.exports=require("datastore-fs")},function(e,t){e.exports=require("path")},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var f=r(n(11));t.fs=f;var a=r(n(39));t.json=a;var i=r(n(37));t.yaml=i},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(3)),i=f(n(2)),o=function(){function e(e,t){this.loom=e,this.name=t,this.head=a.fs.exists(this.path)?this.head:"undefined"}return Object.defineProperty(e.prototype,"path",{get:function(){return i.default.join(this.loom.paths.branches,this.name)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"head",{get:function(){return a.yaml.read(this.path)},set:function(e){a.yaml.write(this.path,e)},enumerable:!0,configurable:!0}),e.new=function(t,n,r){if(e.exists(t,n))throw new Error("Branch "+n+" already exists");return new e(t,n)},e.load=function(t,n,r){if(!e.exists(t,n))throw new Error("Branch "+n+" does not exist");return new e(t,n)},e.exists=function(e,t){return a.fs.exists(i.default.join(e.paths.branches,t))},e.head=function(e,t){return a.yaml.read(i.default.join(e.paths.branches,t))},e}();t.default=o},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},f=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(45)),i=r(n(43)),o=f(n(25)),s=f(n(18)),u=r(n(8));t.Snapshot=u.default;var c=r(n(7));t.Tree=c.default;var l=r(n(6));t.File=l.default;var d=r(n(0));t.IPLDNode=d.default;var p=r(n(12));t.Loom=p.default;var h=r(n(9));t.Index=h.default;var b=r(n(4));t.Branch=b.default;var y=function(){function e(t){this.dao=new a.default(this),this.loom=new i.default(this),this.configuration=t,this.web3=e.utils.web3.get(t.ethereum),this.contracts=e.contracts.initialize(this.web3,t.author.account)}return e.contracts=o,e.utils=s,e}();t.default=y},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=this&&this.__decorate||function(e,t,n,r){var f,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(f=e[o])&&(i=(a<3?f(i):a>3?f(t,n,i):f(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(f,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function o(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?f(e.value):new n(function(t){t(e.value)}).then(i,o)}s((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,f,a,i={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(f=2&a[0]?r.return:a[0]?r.throw||((f=r.return)&&f.call(r),0):r.next)&&!(f=f.call(r,a[1])).done)return f;switch(r=0,f&&(a=[2&a[0],f.value]),a[0]){case 0:case 1:f=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(f=(f=i.trys).length>0&&f[f.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!f||a[1]>f[0]&&a[1]<f[3])){i.label=a[1];break}if(6===a[0]&&i.label<f[1]){i.label=f[1],f=a;break}if(f&&i.label<f[2]){i.label=f[2],i.ops.push(a);break}f[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=f=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n(0)),c=n(0),l=function(e){function t(t,n){var r=e.call(this,"file")||this;return r.path=t.path||void 0,r.link=t.link,r}return r(t,e),t.prototype.put=function(e){return i(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return n=(t=e).put,[4,this.toIPLD()];case 1:return[4,n.apply(t,[r.sent()])];case 2:return[2,r.sent()]}})})},t=f([c.ipld("path"),c.ipld("link",{link:!0,type:"direct"}),a("design:paramtypes",[Object,Object])],t)}(u.default);t.default=l},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=this&&this.__decorate||function(e,t,n,r){var f,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(f=e[o])&&(i=(a<3?f(i):a>3?f(t,n,i):f(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(f,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function o(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?f(e.value):new n(function(t){t(e.value)}).then(i,o)}s((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,f,a,i={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(f=2&a[0]?r.return:a[0]?r.throw||((f=r.return)&&f.call(r),0):r.next)&&!(f=f.call(r,a[1])).done)return f;switch(r=0,f&&(a=[2&a[0],f.value]),a[0]){case 0:case 1:f=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(f=(f=i.trys).length>0&&f[f.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!f||a[1]>f[0]&&a[1]<f[3])){i.label=a[1];break}if(6===a[0]&&i.label<f[1]){i.label=f[1],f=a;break}if(f&&i.label<f[2]){i.label=f[2],i.ops.push(a);break}f[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=f=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n(0)),c=n(0),l=function(e){function t(t,n){var r=e.call(this,"tree")||this;return r.path=t.path||void 0,r.children=t.children||{},r}return r(t,e),t.prototype.put=function(e){return i(this,void 0,void 0,function(){var t,n,r,f,a,i,s;return o(this,function(o){switch(o.label){case 0:return r=(n=e).put,[4,this.toIPLD()];case 1:return[4,r.apply(n,[o.sent()])];case 2:for(a in t=o.sent(),f=[],this.children)f.push(a);i=0,o.label=3;case 3:return i<f.length?(s=f[i],[4,this.children[s].put(e)]):[3,6];case 4:o.sent(),o.label=5;case 5:return i++,[3,3];case 6:return[2,t]}})})},t.get=function(e,t){return i(this,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return[4,e.get(t,"tree")];case 1:return[2,n.sent()]}})})},t=f([c.ipld("path"),c.ipld("children",{link:!0,type:"map"}),a("design:paramtypes",[Object,Object])],t)}(u.default);t.default=l},function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=this&&this.__decorate||function(e,t,n,r){var f,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(f=e[o])&&(i=(a<3?f(i):a>3?f(t,n,i):f(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),s=n(0),u=function(e){function t(t,n){var r=e.call(this,"snapshot")||this;return r.author=t.author,r.tree=t.tree,r.parents=t.parents||[],r.message=t.message,r.timestamp=t.timestamp||Date.now(),r}return r(t,e),t=f([s.ipld("timestamp"),s.ipld("author"),s.ipld("message"),s.ipld("parents",{link:!0,type:"array"}),s.ipld("tree",{link:!0}),a("design:paramtypes",[Object,Object])],t)}(o.default);t.default=u},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(f,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function o(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?f(e.value):new n(function(t){t(e.value)}).then(i,o)}s((r=r.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,r,f,a,i={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(f=2&a[0]?r.return:a[0]?r.throw||((f=r.return)&&f.call(r),0):r.next)&&!(f=f.call(r,a[1])).done)return f;switch(r=0,f&&(a=[2&a[0],f.value]),a[0]){case 0:case 1:f=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(f=(f=i.trys).length>0&&f[f.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!f||a[1]>f[0]&&a[1]<f[3])){i.label=a[1];break}if(6===a[0]&&i.label<f[1]){i.label=f[1],f=a;break}if(f&&i.label<f[2]){i.label=f[2],i.ops.push(a);break}f[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=f=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(3)),s=i(n(2)),u=i(n(29)),c=function(){function e(e){this.loom=e}return Object.defineProperty(e.prototype,"path",{get:function(){return this.loom.paths.index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"current",{get:function(){return o.yaml.read(this.path)},set:function(e){o.yaml.write(this.path,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unsnapshot",{get:function(){var e=this.current,t=[];for(var n in e)e[n].repo!==e[n].stage&&t.push(n);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"staged",{get:function(){var e=this.current,t=[];for(var n in e)"null"!==e[n].stage&&t.push(n);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modified",{get:function(){var e=this.current,t=[];for(var n in e)"null"!==e[n].stage&&e[n].wdir!==e[n].stage&&t.push(n);return t},enumerable:!0,configurable:!0}),e.new=function(t){return r(this,void 0,void 0,function(){return f(this,function(n){return[2,new e(t)]})})},e.load=function(t){return r(this,void 0,void 0,function(){return f(this,function(n){return[2,new e(t)]})})},e.prototype.reinitialize=function(e,t){return r(this,void 0,void 0,function(){var n,r,a,i,o,s,u;return f(this,function(f){switch(f.label){case 0:for(a in n=t||{},delete e["@type"],delete e.path,r=[],e)r.push(a);i=0,f.label=1;case 1:return i<r.length?(o=r[i],[4,this.loom.node.get(e[o]["/"])]):[3,6];case 2:return"tree"!==(s=f.sent())["@type"]?[3,4]:[4,this.reinitialize(s,n)];case 3:return f.sent(),[3,5];case 4:"file"===s["@type"]&&(u=s.link["/"],n[s.path]={mtime:new Date(Date.now()),wdir:u,stage:u,repo:u}),f.label=5;case 5:return i++,[3,1];case 6:return this.current=n,[2]}})})},e.prototype.update=function(){return r(this,void 0,void 0,function(){var e,t,n,r,a,i,o,c,l,d,p,h,b,y,v;return f(this,function(f){switch(f.label){case 0:for(a in e=this.current,t={},n=function(e){return e.path.indexOf(".pando")<0},r=u.default(this.loom.paths.root,{nodir:!0,filter:n}))y=s.default.relative(this.loom.paths.root,r[a].path),i=r[a].stats.mtime,t[y]={mtime:new Date(i)};for(l in o=Object.assign(t),c=[],e)c.push(l);d=0,f.label=1;case 1:return d<c.length?(y=c[d],t[y]?new Date(e[y].mtime)<=new Date(t[y].mtime)?[4,this.loom.node.cid(s.default.join(this.loom.paths.root,y),{file:!0})]:[3,3]:[3,4]):[3,7];case 2:v=f.sent(),e[y].mtime=t[y].mtime,e[y].wdir=v,f.label=3;case 3:return[3,5];case 4:e[y].mtime=new Date(Date.now()),e[y].wdir="null",f.label=5;case 5:delete o[y],f.label=6;case 6:return d++,[3,1];case 7:for(h in p=[],o)p.push(h);b=0,f.label=8;case 8:return b<p.length?(y=p[b],[4,this.loom.node.cid(s.default.join(this.loom.paths.root,y),{file:!0})]):[3,11];case 9:v=f.sent(),e[y]={mtime:t[y].mtime,wdir:v,stage:"null",repo:"null"},f.label=10;case 10:return b++,[3,8];case 11:return this.current=e,[2,e]}})})},e.prototype.stage=function(e){return r(this,void 0,void 0,function(){var t,n,r,a,i,u;return f(this,function(f){switch(f.label){case 0:return[4,this.update()];case 1:t=f.sent(),n=0,r=e,f.label=2;case 2:return n<r.length?(a=r[n],a=s.default.normalize(a),i=s.default.relative(this.loom.paths.root,a),o.fs.exists(a)?[4,this.loom.node.upload(a)]:[3,4]):[3,6];case 3:return u=f.sent(),t[i].stage=u,[3,5];case 4:if("null"!==t[i].wdir)throw new Error(a+" does not exist in current working directory");delete t[i],f.label=5;case 5:return n++,[3,2];case 6:return this.current=t,[2,t]}})})},e}();t.default=c},function(e,t){e.exports=require("ipld-pando")},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(41)),i=f(n(40));t.mkdir=function(e){return a.mkdirSync(e)},t.exists=function(e){return a.existsSync(e)},t.write=function(e,t){return a.writeFileSync(e,t)},t.read=function(e){return a.readFileSync(e)},t.rm=function(e){return i.default.sync(e)}},function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var f in t=arguments[n])Object.prototype.hasOwnProperty.call(t,f)&&(e[f]=t[f]);return e},f=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(f,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function o(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?f(e.value):new n(function(t){t(e.value)}).then(i,o)}s((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,f,a,i={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(f=2&a[0]?r.return:a[0]?r.throw||((f=r.return)&&f.call(r),0):r.next)&&!(f=f.call(r,a[1])).done)return f;switch(r=0,f&&(a=[2&a[0],f.value]),a[0]){case 0:case 1:f=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(f=(f=i.trys).length>0&&f[f.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!f||a[1]>f[0]&&a[1]<f[3])){i.label=a[1];break}if(6===a[0]&&i.label<f[1]){i.label=f[1],f=a;break}if(f&&i.label<f[2]){i.label=f[2],i.ops.push(a);break}f[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=f=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var s=i(n(5)),u=i(n(42)),c=i(n(9)),l=i(n(4)),d=i(n(8)),p=i(n(7)),h=i(n(6)),b=i(n(26)),y=o(n(3)),v=i(n(2)),m=function(){function e(t,n,f){for(var a in void 0===n&&(n="."),this.branch=new b.default(this),this.paths=r({},e.paths),this.paths)this.paths[a]=v.default.join(n,this.paths[a]);this.pando=t}return Object.defineProperty(e.prototype,"currentBranchName",{get:function(){return y.yaml.read(this.paths.current)},set:function(e){y.yaml.write(this.paths.current,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentBranch",{get:function(){return l.default.load(this,this.currentBranchName)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"head",{get:function(){return this.currentBranch.head},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"config",{get:function(){return y.yaml.read(this.paths.config)},set:function(e){y.yaml.write(this.paths.config,e)},enumerable:!0,configurable:!0}),e.new=function(t,n,r){return void 0===n&&(n="."),f(this,void 0,void 0,function(){var r,f,i;return a(this,function(a){switch(a.label){case 0:return r=new e(t,n),[4,y.fs.mkdir(r.paths.pando)];case 1:return a.sent(),[4,y.fs.mkdir(r.paths.ipfs)];case 2:return a.sent(),[4,y.fs.mkdir(r.paths.branches)];case 3:return a.sent(),[4,y.yaml.write(r.paths.index,{})];case 4:return a.sent(),[4,y.yaml.write(r.paths.config,t.configuration)];case 5:return a.sent(),[4,l.default.new(r,"master")];case 6:return a.sent(),[4,y.yaml.write(r.paths.current,"master")];case 7:return a.sent(),f=r,[4,u.default.new(r)];case 8:return f.node=a.sent(),i=r,[4,c.default.new(r)];case 9:return i.index=a.sent(),[2,r]}})})},e.load=function(t,n){return void 0===t&&(t="."),f(this,void 0,void 0,function(){var n,r,f,i;return a(this,function(a){switch(a.label){case 0:if(!e.exists(t))throw new Error("No pando loom found at "+t);return n=new s.default(y.yaml.read(v.default.join(t,e.paths.config))),r=new e(n,t),f=r,[4,u.default.load(r)];case 1:return f.node=a.sent(),i=r,[4,c.default.load(r)];case 2:return i.index=a.sent(),[2,r]}})})},e.exists=function(t){for(var n in void 0===t&&(t="."),e.paths){var r=v.default.join(t,e.paths[n]);if(!y.fs.exists(r))return!1}return!0},e.prototype.stage=function(e){return f(this,void 0,void 0,function(){return a(this,function(t){return[2,this.index.stage(e)]})})},e.prototype.snapshot=function(e){return f(this,void 0,void 0,function(){var t,n,r,f,i,o,s,u;return a(this,function(a){switch(a.label){case 0:return[4,this.index.update()];case 1:if(a.sent(),!this.index.unsnapshot.length)throw new Error("Nothing to snapshot");return[4,this.tree()];case 2:return[4,(t=a.sent()).put(this.node)];case 3:return a.sent(),"undefined"===this.head?[3,6]:(f=this.fromIPLD,[4,this.node.get(this.head)]);case 4:return[4,f.apply(this,[a.sent()])];case 5:return r=[a.sent()],[3,7];case 6:r=void 0,a.label=7;case 7:return n=r,i=new d.default({author:this.pando.configuration.author,tree:t,parents:n,message:e}),u=(s=this.node).put,[4,i.toIPLD()];case 8:return[4,u.apply(s,[a.sent()])];case 9:return o=a.sent(),this.currentBranch.head=o.toBaseEncodedString(),[2,i]}})})},e.prototype.checkout=function(e){return f(this,void 0,void 0,function(){var t,n,r,f,i,o;return a(this,function(a){switch(a.label){case 0:return[4,this.index.update()];case 1:if(a.sent(),!l.default.exists(this,e))throw new Error("Branch "+e+" does not exist");if(this.index.unsnapshot.length)throw new Error("You have unsnapshot modifications: "+this.index.unsnapshot);if(this.index.modified.length)throw new Error("You have unstaged and unsnaphot modifications: "+this.index.modified);return t=l.default.head(this,e),n=this.head,"undefined"===t?[3,8]:(r=void 0,f=void 0,[4,this.node.get(t,"tree")]);case 2:return f=a.sent(),"undefined"===n?[3,4]:[4,this.node.get(n,"tree")];case 3:return r=a.sent(),[3,5];case 4:r=new p.default({path:".",children:[]}).toIPLD(),a.label=5;case 5:return[4,this.updateWorkingDirectory(r,f)];case 6:return a.sent(),[4,this.index.reinitialize(f)];case 7:return a.sent(),[3,11];case 8:return o=(i=this.index).reinitialize,[4,new p.default({path:".",children:[]}).toIPLD()];case 9:return[4,o.apply(i,[a.sent()])];case 10:a.sent(),a.label=11;case 11:return this.currentBranchName=e,[2]}})})},e.prototype.fromIPLD=function(e){return f(this,void 0,void 0,function(){var t,n,r,f,i,o,s,u,c,l,b,y,v,m,w,g,_,P,x,k,j,O,D;return a(this,function(a){switch(a.label){case 0:switch(t={},n={},e["@type"]){case"snapshot":t=Reflect.getMetadata("ipld",d.default.prototype.constructor);break;case"tree":t=Reflect.getMetadata("ipld",p.default.prototype.constructor);break;case"file":t=Reflect.getMetadata("ipld",h.default.prototype.constructor);break;default:throw new TypeError("Unrecognized IPLD node.")}for(i in f=[],t)f.push(i);o=0,a.label=1;case 1:if(!(o<f.length))return[3,21];if(s=f[o],!t[s].link)return[3,19];switch(u=t[s].type,u){case"map":return[3,2];case"array":return[3,8];case"direct":return[3,14]}return[3,15];case 2:for(l in n.children={},c=[],e)c.push(l);b=0,a.label=3;case 3:return b<c.length?"@type"===(_=c[b])||"path"===_?[3,6]:(y=n.children,v=_,m=this.fromIPLD,[4,this.node.get(e[_]["/"])]):[3,7];case 4:return[4,m.apply(this,[a.sent()])];case 5:y[v]=a.sent(),a.label=6;case 6:return b++,[3,3];case 7:return[3,18];case 8:n[s]=[],w=0,g=e[s],a.label=9;case 9:return w<g.length?(_=g[w],x=(P=n[s]).push,k=this.fromIPLD,[4,this.node.get(e[s][_]["/"])]):[3,13];case 10:return[4,k.apply(this,[a.sent()])];case 11:x.apply(P,[a.sent()]),a.label=12;case 12:return w++,[3,9];case 13:return[3,18];case 14:return n[s]=e[s]["/"],[3,18];case 15:return j=n,O=s,D=this.fromIPLD,[4,this.node.get(e[s]["/"])];case 16:return[4,D.apply(this,[a.sent()])];case 17:j[O]=a.sent(),a.label=18;case 18:return[3,20];case 19:n[s]=e[s],a.label=20;case 20:return o++,[3,1];case 21:switch(e["@type"]){case"snapshot":r=new d.default(n);break;case"tree":r=new p.default(n);break;case"file":r=new h.default(n);break;default:throw new TypeError("Unrecognized IPLD node.")}return[2,r]}})})},e.prototype.tree=function(){for(var e=this.index.current,t=this.index.staged,n=new p.default({path:"."}),r=0,f=t;r<f.length;r++){f[r].split(v.default.sep).reduce(function(t,n){var r=v.default.join(t.path,n);return t.children[n]||(e[r]?(t.children[n]=new h.default({path:r,link:e[r].stage}),e[r].repo=e[r].stage):t.children[n]=new p.default({path:r})),t.children[n]},n)}return this.index.current=e,n},e.prototype.updateWorkingDirectory=function(e,t){return f(this,void 0,void 0,function(){var n,r,f,i,o,s,u,c,l,d,p,h;return a(this,function(a){switch(a.label){case 0:for(r in delete e["@type"],delete e.path,delete t["@type"],delete t.path,n=[],t)n.push(r);f=0,a.label=1;case 1:return f<n.length?(p=n[f],e[p]?[3,3]:[4,this.node.download(t[p]["/"])]):[3,15];case 2:return a.sent(),delete e[p],[3,14];case 3:return e[p]["/"]===t[p]["/"]?[3,13]:[4,this.node.get(e[p]["/"],"@type")];case 4:return i=a.sent(),[4,this.node.get(t[p]["/"],"@type")];case 5:return o=a.sent(),i===o?[3,7]:[4,this.node.download(t[p]["/"])];case 6:return a.sent(),[3,13];case 7:return"file"!==i?[3,9]:[4,this.node.download(t[p]["/"])];case 8:return a.sent(),[3,13];case 9:return"tree"!==i?[3,13]:[4,this.node.get(e[p]["/"])];case 10:return s=a.sent(),[4,this.node.get(t[p]["/"])];case 11:return u=a.sent(),[4,this.updateWorkingDirectory(s,u)];case 12:a.sent(),a.label=13;case 13:delete e[p],a.label=14;case 14:return f++,[3,1];case 15:for(l in c=[],e)c.push(l);d=0,a.label=16;case 16:return d<c.length?(p=c[d],[4,this.node.get(e[p]["/"],"path")]):[3,19];case 17:h=a.sent(),y.fs.rm(v.default.join(this.paths.root,h)),a.label=18;case 18:return d++,[3,16];case 19:return[2]}})})},e.paths={root:".",pando:".pando",ipfs:".pando/ipfs",index:".pando/index",current:".pando/current",config:".pando/config",branches:".pando/branches"},e}();t.default=m},function(e,t){e.exports=require("js-sha3")},function(e,t){e.exports=require("eth-ens-namehash")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),f=n(13);t.APP_BASE_NAMESPACE="0x"+f.keccak256("base"),t.namehash=function(e){return r.hash(e)}},function(e,t){e.exports=require("web3")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=r(n(16));t.get=function(e){var t;return e.gateway&&"function"!=typeof(t=new f.default(new f.default.providers.HttpProvider(e.gateway))).currentProvider.sendAsync&&(t.currentProvider.sendAsync=function(){return t.currentProvider.send.apply(t.currentProvider,arguments)}),t}},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var f=r(n(17));t.web3=f;var a=r(n(15));t.aragon=a},function(e){e.exports={contractName:"Pando",abi:[{constant:!0,inputs:[],name:"EVMSCRIPT_REGISTRY_APP_ID",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"appId",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"getInitializationBlock",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"EVMSCRIPT_REGISTRY_APP",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_sender",type:"address"},{name:"_role",type:"bytes32"},{name:"params",type:"uint256[]"}],name:"canPerform",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"PUSH",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"kernel",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"repository",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_script",type:"bytes"}],name:"getExecutor",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[],name:"initialize",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_repository",type:"string"}],name:"setRepository",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"getRepository",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"}],bytecode:"0x6060604052341561000f57600080fd5b610d168061001e6000396000f3006060604052600436106100ba576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063075363ad146100bf57806360b1e0571461011c5780637f44897b1461014d57806380afdea8146101db5780638129fc1c1461020c5780638b3dd749146102215780639b3fdf4c1461024a578063a1658fad1461027b578063cc6804c814610319578063d4aae0c41461034a578063e9176c601461039f578063f92a79ff1461042d575b600080fd5b34156100ca57600080fd5b61011a600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506104ca565b005b341561012757600080fd5b61012f61051e565b60405180826000191660001916815260200191505060405180910390f35b341561015857600080fd5b610160610557565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156101a0578082015181840152602081019050610185565b50505050905090810190601f1680156101cd5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101e657600080fd5b6101ee6105ff565b60405180826000191660001916815260200191505060405180910390f35b341561021757600080fd5b61021f610605565b005b341561022c57600080fd5b610234610620565b6040518082815260200191505060405180910390f35b341561025557600080fd5b61025d61062a565b60405180826000191660001916815260200191505060405180910390f35b341561028657600080fd5b6102ff600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803560001916906020019091908035906020019082018035906020019080806020026020016040519081016040528093929190818152602001838360200280828437820191505050505050919050506106c5565b604051808215151515815260200191505060405180910390f35b341561032457600080fd5b61032c6108c5565b60405180826000191660001916815260200191505060405180910390f35b341561035557600080fd5b61035d6108cc565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156103aa57600080fd5b6103b26108f1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156103f25780820151818401526020810190506103d7565b50505050905090810190601f16801561041f5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561043857600080fd5b610488600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190505061098f565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b600180026104f8338260006040518059106104e25750595b90808252806020026020018201604052506106c5565b151561050357600080fd5b8160649080519060200190610519929190610c1d565b505050565b60405180807f65766d7265672e617261676f6e706d2e657468000000000000000000000000008152506013019050604051809103902081565b61055f610c9d565b60648054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156105f55780601f106105ca576101008083540402835291602001916105f5565b820191906000526020600020905b8154815290600101906020018083116105d857829003601f168201915b5050505050905090565b60015481565b600060035414151561061657600080fd5b61061e610a96565b565b6000600354905090565b60405180807f61707000000000000000000000000000000000000000000000000000000000008152506003019050604051809103902060405180807f65766d7265672e617261676f6e706d2e6574680000000000000000000000000081525060130190506040518091039020604051808360001916600019168152602001826000191660001916815260200192505050604051809103902081565b60006106cf610cb1565b600080845111156106e857602084510290508391508082525b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614806108ba57506000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663fdef9106873088866000604051602001526040518563ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001836000191660001916815260200180602001828103825283818151815260200191508051906020019080838360005b83811015610850578082015181840152602081019050610835565b50505050905090810190601f16801561087d5780820380516001836020036101000a031916815260200191505b5095505050505050602060405180830381600087803b151561089e57600080fd5b6102c65a03f115156108af57600080fd5b505050604051805190505b925050509392505050565b6001800281565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60648054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156109875780601f1061095c57610100808354040283529160200191610987565b820191906000526020600020905b81548152906001019060200180831161096a57829003601f168201915b505050505081565b6000610999610ab7565b73ffffffffffffffffffffffffffffffffffffffff166304bf2a7f836000604051602001526040518263ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018080602001828103825283818151815260200191508051906020019080838360005b83811015610a29578082015181840152602081019050610a0e565b50505050905090810190601f168015610a565780820380516001836020036101000a031916815260200191505b5092505050602060405180830381600087803b1515610a7457600080fd5b6102c65a03f11515610a8557600080fd5b505050604051805190509050919050565b6000600354141515610aa757600080fd5b610aaf610c15565b600381905550565b6000806000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166342c71f1d60405180807f61707000000000000000000000000000000000000000000000000000000000008152506003019050604051809103902060405180807f65766d7265672e617261676f6e706d2e657468000000000000000000000000008152506013019050604051809103902060405180836000191660001916815260200182600019166000191681526020019250505060405180910390206000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808260001916600019168152602001915050602060405180830381600087803b1515610bf157600080fd5b6102c65a03f11515610c0257600080fd5b5050506040518051905090508091505090565b600043905090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10610c5e57805160ff1916838001178555610c8c565b82800160010185558215610c8c579182015b82811115610c8b578251825591602001919060010190610c70565b5b509050610c999190610cc5565b5090565b602060405190810160405280600081525090565b602060405190810160405280600081525090565b610ce791905b80821115610ce3576000816000905550600101610ccb565b5090565b905600a165627a7a72305820a5d9ef39d7cc4258f3b3aac57e49655081fd3da6eca0a3daa8683acd7ef0a8370029",deployedBytecode:"0x6060604052600436106100ba576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063075363ad146100bf57806360b1e0571461011c5780637f44897b1461014d57806380afdea8146101db5780638129fc1c1461020c5780638b3dd749146102215780639b3fdf4c1461024a578063a1658fad1461027b578063cc6804c814610319578063d4aae0c41461034a578063e9176c601461039f578063f92a79ff1461042d575b600080fd5b34156100ca57600080fd5b61011a600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506104ca565b005b341561012757600080fd5b61012f61051e565b60405180826000191660001916815260200191505060405180910390f35b341561015857600080fd5b610160610557565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156101a0578082015181840152602081019050610185565b50505050905090810190601f1680156101cd5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101e657600080fd5b6101ee6105ff565b60405180826000191660001916815260200191505060405180910390f35b341561021757600080fd5b61021f610605565b005b341561022c57600080fd5b610234610620565b6040518082815260200191505060405180910390f35b341561025557600080fd5b61025d61062a565b60405180826000191660001916815260200191505060405180910390f35b341561028657600080fd5b6102ff600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803560001916906020019091908035906020019082018035906020019080806020026020016040519081016040528093929190818152602001838360200280828437820191505050505050919050506106c5565b604051808215151515815260200191505060405180910390f35b341561032457600080fd5b61032c6108c5565b60405180826000191660001916815260200191505060405180910390f35b341561035557600080fd5b61035d6108cc565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156103aa57600080fd5b6103b26108f1565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156103f25780820151818401526020810190506103d7565b50505050905090810190601f16801561041f5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561043857600080fd5b610488600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190505061098f565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b600180026104f8338260006040518059106104e25750595b90808252806020026020018201604052506106c5565b151561050357600080fd5b8160649080519060200190610519929190610c1d565b505050565b60405180807f65766d7265672e617261676f6e706d2e657468000000000000000000000000008152506013019050604051809103902081565b61055f610c9d565b60648054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156105f55780601f106105ca576101008083540402835291602001916105f5565b820191906000526020600020905b8154815290600101906020018083116105d857829003601f168201915b5050505050905090565b60015481565b600060035414151561061657600080fd5b61061e610a96565b565b6000600354905090565b60405180807f61707000000000000000000000000000000000000000000000000000000000008152506003019050604051809103902060405180807f65766d7265672e617261676f6e706d2e6574680000000000000000000000000081525060130190506040518091039020604051808360001916600019168152602001826000191660001916815260200192505050604051809103902081565b60006106cf610cb1565b600080845111156106e857602084510290508391508082525b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614806108ba57506000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663fdef9106873088866000604051602001526040518563ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001836000191660001916815260200180602001828103825283818151815260200191508051906020019080838360005b83811015610850578082015181840152602081019050610835565b50505050905090810190601f16801561087d5780820380516001836020036101000a031916815260200191505b5095505050505050602060405180830381600087803b151561089e57600080fd5b6102c65a03f115156108af57600080fd5b505050604051805190505b925050509392505050565b6001800281565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60648054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156109875780601f1061095c57610100808354040283529160200191610987565b820191906000526020600020905b81548152906001019060200180831161096a57829003601f168201915b505050505081565b6000610999610ab7565b73ffffffffffffffffffffffffffffffffffffffff166304bf2a7f836000604051602001526040518263ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018080602001828103825283818151815260200191508051906020019080838360005b83811015610a29578082015181840152602081019050610a0e565b50505050905090810190601f168015610a565780820380516001836020036101000a031916815260200191505b5092505050602060405180830381600087803b1515610a7457600080fd5b6102c65a03f11515610a8557600080fd5b505050604051805190509050919050565b6000600354141515610aa757600080fd5b610aaf610c15565b600381905550565b6000806000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166342c71f1d60405180807f61707000000000000000000000000000000000000000000000000000000000008152506003019050604051809103902060405180807f65766d7265672e617261676f6e706d2e657468000000000000000000000000008152506013019050604051809103902060405180836000191660001916815260200182600019166000191681526020019250505060405180910390206000604051602001526040518263ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401808260001916600019168152602001915050602060405180830381600087803b1515610bf157600080fd5b6102c65a03f11515610c0257600080fd5b5050506040518051905090508091505090565b600043905090565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10610c5e57805160ff1916838001178555610c8c565b82800160010185558215610c8c579182015b82811115610c8b578251825591602001919060010190610c70565b5b509050610c999190610cc5565b5090565b602060405190810160405280600081525090565b602060405190810160405280600081525090565b610ce791905b80821115610ce3576000816000905550600101610ccb565b5090565b905600a165627a7a72305820a5d9ef39d7cc4258f3b3aac57e49655081fd3da6eca0a3daa8683acd7ef0a8370029",sourceMap:"58:356:0:-;;;;;;;;;;;;;;;;;",deployedSourceMap:"58:356:0:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;236:91;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;69:84:8;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;331:81:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;113:20:3;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;175:57:0;;;;;;;;;;;;;;269:107:5;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;159:103:8;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;506:494:4;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;93:41:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;86:21:3;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;145:24:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;824:169:6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;236:91:0;132:1;124:10;;306:47:4;317:10;329:5;350:1;336:16;;;;;;;;;;;;;;;;;;;;;;;;306:10;:47::i;:::-;298:56;;;;;;;;311:11:0;298:10;:24;;;;;;;;;;;;:::i;:::-;;236:91;;:::o;69:84:8:-;121:32;;;;;;;;;;;;;;;;;;;69:84;:::o;331:81:0:-;374:6;;:::i;:::-;397:10;390:17;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;331:81;:::o;113:20:3:-;;;;:::o;175:57:0:-;163:1:5;140:19;;:24;132:33;;;;;;;;214:13:0;:11;:13::i;:::-;175:57::o;269:107:5:-;324:7;350:19;;343:26;;269:107;:::o;159:103:8:-;218:16;;;;;;;;;;;;;;;;;;;121:32;;;;;;;;;;;;;;;;;;;208:54;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;159:103;:::o;506:494:4:-;597:4;613:16;;:::i;:::-;722:18;705:1;689:6;:13;:17;685:212;;;759:2;743:6;:13;:18;722:39;;809:6;802:13;;862:10;857:3;850:6;784:103;932:1;921:6;;;;;;;;;;;913:20;;;:80;;;;937:6;;;;;;;;;;;:20;;;958:7;975:4;982:5;989:3;937:56;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;913:80:4;906:87;;506:494;;;;;;;:::o;93:41:0:-;132:1;124:10;;93:41;:::o;86:21:3:-;;;;;;;;;;;;;:::o;145:24:0:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::o;824:169:6:-;881:18;937:21;:19;:21::i;:::-;:39;;;977:7;937:48;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;23:1:-1;8:100;33:3;30:1;27:2;8:100;;;99:1;94:3;90;84:5;80:1;75:3;71;64:6;52:2;49:1;45:3;40:15;;8:100;;;12:14;3:109;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;911:75:6;;824:169;;;:::o;487:96:5:-;163:1;140:19;;:24;132:33;;;;;;;;560:16;:14;:16::i;:::-;538:19;:38;;;;487:96::o;1021:200:6:-;1075:18;1105:20;1128:6;;;;;;;;;;;:13;;;218:16:8;;;;;;;;;;;;;;;;;;;121:32;;;;;;;;;;;;;;;;;;;208:54;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1128:37:6;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;1105:60;;1201:12;1175:39;;1021:200;;:::o;767:94:5:-;816:7;842:12;835:19;;767:94;:::o;58:356:0:-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;:::o;:::-;;;;;;;;;;;;;;;:::o;:::-;;;;;;;;;;;;;;;:::o;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;:::o",source:'pragma solidity ^0.4.19;\n\nimport "./apps/AragonApp.sol";\n\ncontract Pando is AragonApp {\n  \n  bytes32 constant public PUSH = bytes32(1);\n      \n  string public repository;\n\n\n  function initialize() onlyInit {\n      initialized();\n  }\n\n  function setRepository(string _repository) auth(PUSH) {\n      repository = _repository;\n  }\n\n  function getRepository() constant returns (string) {\n      return repository;\n  }\n}',sourcePath:"/Users/osarrouy/Documents/Devs/dapps/@wespr/swarm/contracts/Pando.sol",ast:{attributes:{absolutePath:"/Users/osarrouy/Documents/Devs/dapps/@wespr/swarm/contracts/Pando.sol",exportedSymbols:{Pando:[42]}},children:[{attributes:{literals:["solidity","^","0.4",".19"]},id:1,name:"PragmaDirective",src:"0:24:0"},{attributes:{SourceUnit:650,absolutePath:"/Users/osarrouy/Documents/Devs/dapps/@wespr/swarm/contracts/apps/AragonApp.sol",file:"./apps/AragonApp.sol",scope:43,symbolAliases:[null],unitAlias:""},id:2,name:"ImportDirective",src:"26:30:0"},{attributes:{contractDependencies:[437,551,649,693,829,860],contractKind:"contract",documentation:null,fullyImplemented:!0,linearizedBaseContracts:[42,649,829,860,437,693,551],name:"Pando",scope:43},children:[{attributes:{arguments:[null]},children:[{attributes:{contractScope:null,name:"AragonApp",referencedDeclaration:649,type:"contract AragonApp"},id:3,name:"UserDefinedTypeName",src:"76:9:0"}],id:4,name:"InheritanceSpecifier",src:"76:9:0"},{attributes:{constant:!0,name:"PUSH",scope:42,stateVariable:!0,storageLocation:"default",type:"bytes32",visibility:"public"},children:[{attributes:{name:"bytes32",type:"bytes32"},id:5,name:"ElementaryTypeName",src:"93:7:0"},{attributes:{argumentTypes:null,isConstant:!1,isLValue:!1,isPure:!0,isStructConstructorCall:!1,lValueRequested:!1,names:[null],type:"bytes32",type_conversion:!0},children:[{attributes:{argumentTypes:[{typeIdentifier:"t_rational_1_by_1",typeString:"int_const 1"}],isConstant:!1,isLValue:!1,isPure:!0,lValueRequested:!1,type:"type(bytes32)",value:"bytes32"},id:6,name:"ElementaryTypeNameExpression",src:"124:7:0"},{attributes:{argumentTypes:null,hexvalue:"31",isConstant:!1,isLValue:!1,isPure:!0,lValueRequested:!1,subdenomination:null,token:"number",type:"int_const 1",value:"1"},id:7,name:"Literal",src:"132:1:0"}],id:8,name:"FunctionCall",src:"124:10:0"}],id:9,name:"VariableDeclaration",src:"93:41:0"},{attributes:{constant:!1,name:"repository",scope:42,stateVariable:!0,storageLocation:"default",type:"string storage ref",value:null,visibility:"public"},children:[{attributes:{name:"string",type:"string storage pointer"},id:10,name:"ElementaryTypeName",src:"145:6:0"}],id:11,name:"VariableDeclaration",src:"145:24:0"},{attributes:{constant:!1,implemented:!0,isConstructor:!1,name:"initialize",payable:!1,scope:42,stateMutability:"nonpayable",superFunction:null,visibility:"public"},children:[{attributes:{parameters:[null]},children:[],id:12,name:"ParameterList",src:"194:2:0"},{attributes:{parameters:[null]},children:[],id:15,name:"ParameterList",src:"206:0:0"},{attributes:{arguments:[null]},children:[{attributes:{argumentTypes:null,overloadedDeclarations:[null],referencedDeclaration:664,type:"modifier ()",value:"onlyInit"},id:13,name:"Identifier",src:"197:8:0"}],id:14,name:"ModifierInvocation",src:"197:8:0"},{children:[{children:[{attributes:{argumentTypes:null,arguments:[null],isConstant:!1,isLValue:!1,isPure:!1,isStructConstructorCall:!1,lValueRequested:!1,names:[null],type:"tuple()",type_conversion:!1},children:[{attributes:{argumentTypes:[null],overloadedDeclarations:[null],referencedDeclaration:683,type:"function ()",value:"initialized"},id:16,name:"Identifier",src:"214:11:0"}],id:17,name:"FunctionCall",src:"214:13:0"}],id:18,name:"ExpressionStatement",src:"214:13:0"}],id:19,name:"Block",src:"206:26:0"}],id:20,name:"FunctionDefinition",src:"175:57:0"},{attributes:{constant:!1,implemented:!0,isConstructor:!1,name:"setRepository",payable:!1,scope:42,stateMutability:"nonpayable",superFunction:null,visibility:"public"},children:[{children:[{attributes:{constant:!1,name:"_repository",scope:33,stateVariable:!1,storageLocation:"default",type:"string memory",value:null,visibility:"internal"},children:[{attributes:{name:"string",type:"string storage pointer"},id:21,name:"ElementaryTypeName",src:"259:6:0"}],id:22,name:"VariableDeclaration",src:"259:18:0"}],id:23,name:"ParameterList",src:"258:20:0"},{attributes:{parameters:[null]},children:[],id:27,name:"ParameterList",src:"290:0:0"},{children:[{attributes:{argumentTypes:null,overloadedDeclarations:[null],referencedDeclaration:584,type:"modifier (bytes32)",value:"auth"},id:24,name:"Identifier",src:"279:4:0"},{attributes:{argumentTypes:null,overloadedDeclarations:[null],referencedDeclaration:9,type:"bytes32",value:"PUSH"},id:25,name:"Identifier",src:"284:4:0"}],id:26,name:"ModifierInvocation",src:"279:10:0"},{children:[{children:[{attributes:{argumentTypes:null,isConstant:!1,isLValue:!1,isPure:!1,lValueRequested:!1,operator:"=",type:"string storage ref"},children:[{attributes:{argumentTypes:null,overloadedDeclarations:[null],referencedDeclaration:11,type:"string storage ref",value:"repository"},id:28,name:"Identifier",src:"298:10:0"},{attributes:{argumentTypes:null,overloadedDeclarations:[null],referencedDeclaration:22,type:"string memory",value:"_repository"},id:29,name:"Identifier",src:"311:11:0"}],id:30,name:"Assignment",src:"298:24:0"}],id:31,name:"ExpressionStatement",src:"298:24:0"}],id:32,name:"Block",src:"290:37:0"}],id:33,name:"FunctionDefinition",src:"236:91:0"},{attributes:{constant:!0,implemented:!0,isConstructor:!1,modifiers:[null],name:"getRepository",payable:!1,scope:42,stateMutability:"view",superFunction:null,visibility:"public"},children:[{attributes:{parameters:[null]},children:[],id:34,name:"ParameterList",src:"353:2:0"},{children:[{attributes:{constant:!1,name:"",scope:41,stateVariable:!1,storageLocation:"default",type:"string memory",value:null,visibility:"internal"},children:[{attributes:{name:"string",type:"string storage pointer"},id:35,name:"ElementaryTypeName",src:"374:6:0"}],id:36,name:"VariableDeclaration",src:"374:6:0"}],id:37,name:"ParameterList",src:"373:8:0"},{children:[{attributes:{functionReturnParameters:37},children:[{attributes:{argumentTypes:null,overloadedDeclarations:[null],referencedDeclaration:11,type:"string storage ref",value:"repository"},id:38,name:"Identifier",src:"397:10:0"}],id:39,name:"Return",src:"390:17:0"}],id:40,name:"Block",src:"382:30:0"}],id:41,name:"FunctionDefinition",src:"331:81:0"}],id:42,name:"ContractDefinition",src:"58:356:0"}],id:43,name:"SourceUnit",src:"0:414:0"},compiler:{name:"solc",version:"0.4.19+commit.c4cbbb05.Emscripten.clang"},networks:{},schemaVersion:"1.0.1",updatedAt:"2018-03-01T11:33:06.395Z"}},function(e,t){e.exports=require("@aragon/os/build/contracts/AppProxyUpgradeable.json")},function(e,t){e.exports=require("@aragon/os/build/contracts/ACL.json")},function(e,t){e.exports=require("@aragon/os/build/contracts/DAOFactory.json")},function(e,t){e.exports=require("@aragon/os/build/contracts/Kernel.json")},function(e,t){e.exports=require("truffle-contract")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=r(n(24));t.artifacts={kernel:n(23),daoFactory:n(22),acl:n(21),appProxyUpgradeable:n(20),pando:n(19)},t.kernel=f.default(t.artifacts.kernel),t.daoFactory=f.default(t.artifacts.daoFactory),t.acl=f.default(t.artifacts.acl),t.pando=f.default(t.artifacts.pando),t.appProxyUpgradeable=f.default(t.artifacts.appProxyUpgradeable),t.initialize=function(e,n){var r={};for(var a in t.artifacts)r[a]=f.default(t.artifacts[a]),r[a].setProvider(e.currentProvider),r[a].defaults({from:n,gas:1e8});return r}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(f,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function o(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?f(e.value):new n(function(t){t(e.value)}).then(i,o)}s((r=r.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,r,f,a,i={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(f=2&a[0]?r.return:a[0]?r.throw||((f=r.return)&&f.call(r),0):r.next)&&!(f=f.call(r,a[1])).done)return f;switch(r=0,f&&(a=[2&a[0],f.value]),a[0]){case 0:case 1:f=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(f=(f=i.trys).length>0&&f[f.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!f||a[1]>f[0]&&a[1]<f[3])){i.label=a[1];break}if(6===a[0]&&i.label<f[1]){i.label=f[1],f=a;break}if(f&&i.label<f[2]){i.label=f[2],i.ops.push(a);break}f[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=f=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(4)),o=function(){function e(e){this.loom=e}return e.prototype.new=function(e,t){return r(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,i.default.new(this.loom,e)];case 1:return[2,t.sent()]}})})},e}();t.default=o},function(e,t){e.exports=require("reflect-metadata")},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("klaw-sync")},function(e,t){e.exports=require("promisify-event")},function(e,t){e.exports=require("cids")},function(e,t){e.exports=require("ipld")},function(e,t){e.exports=require("ipfs-repo/src/lock-memory")},function(e,t){e.exports=require("ipfs-repo")},function(e,t){e.exports=require("ipfs")},function(e,t){e.exports=require("js-yaml")},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(11)),i=f(n(36));t.read=function(e){return i.default.safeLoad(a.read(e))},t.write=function(e,t,n){return a.write(e,i.default.safeDump(t,n))}},function(e,t){e.exports=require("jsonfile")},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var f=r(n(38));t.write=function(e,t){return f.writeFileSync(e,t)},t.read=function(e){return f.readFileSync(e)}},function(e,t){e.exports=require("rimraf")},function(e,t){e.exports=require("fs")},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(f,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function o(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?f(e.value):new n(function(t){t(e.value)}).then(i,o)}s((r=r.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,r,f,a,i={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(f=2&a[0]?r.return:a[0]?r.throw||((f=r.return)&&f.call(r),0):r.next)&&!(f=f.call(r,a[1])).done)return f;switch(r=0,f&&(a=[2&a[0],f.value]),a[0]){case 0:case 1:f=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(f=(f=i.trys).length>0&&f[f.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!f||a[1]>f[0]&&a[1]<f[3])){i.label=a[1];break}if(6===a[0]&&i.label<f[1]){i.label=f[1],f=a;break}if(f&&i.label<f[2]){i.label=f[2],i.ops.push(a);break}f[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=f=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(3)),s=i(n(35)),u=i(n(34)),c=i(n(33)),l=i(n(32)),d=i(n(10)),p=i(n(31)),h=i(n(30)),b=i(n(2)),y={storageBackends:{root:n(1),blocks:n(1),keys:n(1),datastore:n(1)},storageBackendOptions:{root:{extension:".ipfsroot",errorIfExists:!1,createIfMissing:!0},blocks:{sharding:!1,extension:".ipfsblock",errorIfExists:!1,createIfMissing:!0},keys:{extension:".ipfskey",errorIfExists:!1,createIfMissing:!0},datastore:{extension:".ipfsds",errorIfExists:!1,createIfMissing:!0}},lock:c.default},v=function(){function e(e,t,n){this.loom=e,this.ipfs=t,this.ipld=n}return e.new=function(t){return r(this,void 0,void 0,function(){var n,r,a;return f(this,function(f){switch(f.label){case 0:return n=new u.default(t.paths.ipfs,y),r=new s.default({repo:n,start:!1}),[4,h.default(r,"ready")];case 1:return f.sent(),(a=new l.default(r.block)).support.rm("raw"),a.support.add("raw",d.default.resolver,d.default.util),[2,new e(t,r,a)]}})})},e.load=function(t){return r(this,void 0,void 0,function(){var n,r,a;return f(this,function(f){switch(f.label){case 0:return n=new u.default(t.paths.ipfs,y),r=new s.default({repo:n,init:!1,start:!1}),[4,h.default(r,"ready")];case 1:return f.sent(),(a=new l.default(r.block)).support.rm("raw"),a.support.add("raw",d.default.resolver,d.default.util),[2,new e(t,r,a)]}})})},e.prototype.upload=function(e){return r(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,this.ipfs.files.add([{path:b.default.relative(this.loom.paths.root,e),content:o.fs.read(e)}])];case 1:return[2,t.sent()[0].hash]}})})},e.prototype.download=function(e,t){return r(this,void 0,void 0,function(){var t=this;return f(this,function(n){return[2,new Promise(function(n,a){return r(t,void 0,void 0,function(){var t,i=this;return f(this,function(s){return t=p.default.isCID(e)?e:new p.default(e),this.ipld.get(t,function(e,t){return r(i,void 0,void 0,function(){var r,i,s,u;return f(this,function(f){switch(f.label){case 0:return e?(a(e),[3,5]):[3,1];case 1:if(r=t.value,i=b.default.join(this.loom.paths.root,r.path),"tree"!==r["@type"])return[3,2];for(s in o.fs.exists(i)||o.fs.mkdir(i),delete r["@type"],delete r.path,r)this.download(r[s]["/"]);return[3,4];case 2:return"file"!==r["@type"]?[3,4]:[4,this.ipfs.files.cat(r.link["/"])];case 3:u=f.sent(),o.fs.write(i,u),f.label=4;case 4:n(!0),f.label=5;case 5:return[2]}})})}),[2]})})})]})})},e.prototype.put=function(e){return r(this,void 0,void 0,function(){var t=this;return f(this,function(n){return[2,new Promise(function(n,a){return r(t,void 0,void 0,function(){var t=this;return f(this,function(i){return this.ipld.put(e,{format:"raw",hashAlg:"keccak-256"},function(e,i){return r(t,void 0,void 0,function(){return f(this,function(t){return e?a(e):n(i),[2]})})}),[2]})})})]})})},e.prototype.get=function(e,t){return r(this,void 0,void 0,function(){var n=this;return f(this,function(a){return[2,new Promise(function(a,i){return r(n,void 0,void 0,function(){var n,o=this;return f(this,function(s){return n=p.default.isCID(e)?e:new p.default(e),this.ipld.get(n,t||"",function(e,t){return r(o,void 0,void 0,function(){return f(this,function(n){return e?i(e):a(t.value),[2]})})}),[2]})})})]})})},e.prototype.cid=function(e,t){return r(this,void 0,void 0,function(){var n;return f(this,function(r){switch(r.label){case 0:return t.file?(n=[{path:b.default.relative(this.loom.paths.root,e),content:o.fs.read(e)}],[4,this.ipfs.files.add(n,{"only-hash":!0})]):[3,2];case 1:return[2,r.sent()[0].hash];case 2:return[2]}})})},e}();t.default=v},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(f,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function o(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?f(e.value):new n(function(t){t(e.value)}).then(i,o)}s((r=r.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,r,f,a,i={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(f=2&a[0]?r.return:a[0]?r.throw||((f=r.return)&&f.call(r),0):r.next)&&!(f=f.call(r,a[1])).done)return f;switch(r=0,f&&(a=[2&a[0],f.value]),a[0]){case 0:case 1:f=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(f=(f=i.trys).length>0&&f[f.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!f||a[1]>f[0]&&a[1]<f[3])){i.label=a[1];break}if(6===a[0]&&i.label<f[1]){i.label=f[1],f=a;break}if(f&&i.label<f[2]){i.label=f[2],i.ops.push(a);break}f[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=f=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(12)),o=function(){function e(e){this.pando=e}return e.prototype.new=function(e){return void 0===e&&(e="."),r(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,i.default.new(this.pando,e)];case 1:return[2,t.sent()]}})})},e.prototype.load=function(e){return void 0===e&&(e="."),r(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,i.default.load(e)];case 1:return[2,t.sent()]}})})},e}();t.default=o},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(f,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function o(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?f(e.value):new n(function(t){t(e.value)}).then(i,o)}s((r=r.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,r,f,a,i={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(f=2&a[0]?r.return:a[0]?r.throw||((f=r.return)&&f.call(r),0):r.next)&&!(f=f.call(r,a[1])).done)return f;switch(r=0,f&&(a=[2&a[0],f.value]),a[0]){case 0:case 1:f=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(f=(f=i.trys).length>0&&f[f.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!f||a[1]>f[0]&&a[1]<f[3])){i.label=a[1];break}if(6===a[0]&&i.label<f[1]){i.label=f[1],f=a;break}if(f&&i.label<f[2]){i.label=f[2],i.ops.push(a);break}f[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=f=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(5)),o=function(){function e(e,t,n,r){this.pando=e,this.kernel=t,this.acl=n}return e.deploy=function(t,n){return r(this,void 0,void 0,function(){var n,r,a,i,o,s,u,c;return f(this,function(f){switch(f.label){case 0:return[4,t.contracts.kernel.new()];case 1:return n=f.sent(),[4,t.contracts.acl.new()];case 2:return r=f.sent(),[4,t.contracts.daoFactory.new(n.address,r.address,"0x00")];case 3:return[4,f.sent().newDAO(t.configuration.author.account)];case 4:return a=f.sent(),i=a.logs.filter(function(e){return"DeployDAO"===e.event})[0].args.dao,[4,t.contracts.kernel.at(i)];case 5:return o=f.sent(),c=(u=t.contracts.acl).at,[4,o.acl()];case 6:return[4,c.apply(u,[f.sent()])];case 7:return s=f.sent(),console.log("Kernel deployed at: "+o.address),[2,new e(t,o,s)]}})})},e.prototype.grantAppManagerRole=function(e){return r(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return[4,this.kernel.APP_MANAGER_ROLE()];case 1:return e=t.sent(),[4,this.acl.createPermission(this.pando.configuration.author.account,this.kernel.address,e,this.pando.configuration.author.account)];case 2:return[2,t.sent()]}})})},e.prototype.deployTree=function(e){return r(this,void 0,void 0,function(){var e,t,n,r,a,o;return f(this,function(f){switch(f.label){case 0:return e=i.default.utils.aragon.APP_BASE_NAMESPACE,t=i.default.utils.aragon.namehash("pando.aragonpm.test"),[4,this.pando.contracts.pando.new()];case 1:return n=f.sent(),[4,this.kernel.setApp(e,t,n.address)];case 2:return r=f.sent(),a=n.contract.initialize.getData(),[4,this.pando.contracts.appProxyUpgradeable.new(this.kernel.address,t,a,{gas:5e6})];case 3:return f.sent(),o=this,[4,this.pando.contracts.pando.at(n.address)];case 4:return o.tree=f.sent(),console.log("Tree app deployed at: "+this.tree.address),[2,r]}})})},e.prototype.push=function(e){return r(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,this.tree.setRepository(e)];case 1:return[2,t.sent()]}})})},e.prototype.head=function(){return r(this,void 0,void 0,function(){return f(this,function(e){switch(e.label){case 0:return[4,this.tree.getRepository()];case 1:return[2,e.sent()]}})})},e.prototype.grantPushRole=function(){var e=this;return new Promise(function(t,n){return r(e,void 0,void 0,function(){var e,r,a;return f(this,function(f){switch(f.label){case 0:return f.trys.push([0,3,,4]),[4,this.tree.PUSH()];case 1:return e=f.sent(),[4,this.acl.grantPermission(this.pando.configuration.author.account,this.tree.address,e)];case 2:return r=f.sent(),t(r),[3,4];case 3:return a=f.sent(),n(a),[3,4];case 4:return[2]}})})})},e}();t.default=o},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(f,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function o(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){e.done?f(e.value):new n(function(t){t(e.value)}).then(i,o)}s((r=r.apply(e,t||[])).next())})},f=this&&this.__generator||function(e,t){var n,r,f,a,i={label:0,sent:function(){if(1&f[0])throw f[1];return f[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(f=2&a[0]?r.return:a[0]?r.throw||((f=r.return)&&f.call(r),0):r.next)&&!(f=f.call(r,a[1])).done)return f;switch(r=0,f&&(a=[2&a[0],f.value]),a[0]){case 0:case 1:f=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(f=(f=i.trys).length>0&&f[f.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!f||a[1]>f[0]&&a[1]<f[3])){i.label=a[1];break}if(6===a[0]&&i.label<f[1]){i.label=f[1],f=a;break}if(f&&i.label<f[2]){i.label=f[2],i.ops.push(a);break}f[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=f=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(44)),o=function(){function e(e){this.pando=e}return e.prototype.create=function(){return r(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return[4,i.default.deploy(this.pando)];case 1:return[4,(e=t.sent()).grantAppManagerRole()];case 2:return t.sent(),[4,e.deployTree()];case 3:return t.sent(),[2,e]}})})},e}();t.default=o}])});